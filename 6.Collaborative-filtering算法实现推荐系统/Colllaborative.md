# 问题描述

![image-20210130093727177](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130093727177.png)

根据一个涉及影评者及其几部影片评分情况的字典，实现collaborative filtering，并为Toby进行推荐。

**对于本题使用两种方法分别求解**

# 方法1 - Latent factor Methods

## 思路描述

这一种方法使用的是collaborative filtering中的latent factor methods（潜在因子算法）。

这个算法在实现过程中主要用到了课上所讲的矩阵分解的方法. 矩阵分解就是把原来的大矩阵，近似的分解成小矩阵的乘积，在实际推荐计算时不再使用大矩阵，而是使用分解得到的两个小矩阵.

找到这样两个矩阵：

一，用户-潜在因子矩阵 作为矩阵1。二，潜在因子-电影矩阵作为矩阵2。

利用这两个矩阵，将他们相乘可以得到不同用户对不同电影的评分矩阵R

本题给出的是不同⽤户对不同电影的评分矩阵R，但是部分内容空缺，我们要做的是根据提供的部分补全矩阵，完成对未评分电影的评分预测，实现对Toby推荐。

主要思路是先通过numpy随机⽣成两个矩阵，然后计算与初始矩阵R的误差，利⽤随机梯度下降的方法对其迭代，逐渐缩⼩损失值，最后得到优化的矩阵1和矩阵2，并计算得到最终的推荐矩阵R。

 

## 1.  数据输入和预览

![image-20210130094147135](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130094147135.png)

  可以看到题目提供的用户评分表有部分值是空缺的我们,将其置为零,本题要做的便是,通过协同滤波器的矩阵分解方法预测该表中空缺位置的取值.

## 2.  随机生成矩阵1和矩阵2 

![image-20210130094108878](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130094108878.png)

如上图所示,根据矩阵分解理论随机生成两个含有影响因子维度(这里取影响因子为4)的矩阵,作为进行梯度下降的初始矩阵.

## 3.  计算误差和进行梯度下降迭代

这里训练参数设置为了迭代次数2000次，学习率0.002下beta 0.02,停止训练的阈值为0.001

 

## 结果分析

![img](https://gitee.com/sun-roc/picture/raw/master/img/clip_image006.jpg)

![img](https://gitee.com/sun-roc/picture/raw/master/img/clip_image008.jpg)

第一张图显示了根据预测矩阵可以得到所有用户的评分值预测

第二张图显示了对于题目所给的电影,Toby未看过的电影的可能预测值,我们根据预测值,可以向Toby推荐电影.

![img](https://gitee.com/sun-roc/picture/raw/master/img/clip_image010.jpg)

多次改变迭代次数、学习率取值发现，推荐的结果基本不变，但有时可能会出现负值的过拟合现象,因此应当取较小的学习率来防止出现过拟合的现象。因此迭代次数2000次，学习率0.0002是⼀组比较理想的取值。

推荐电影的顺序为1. The Night Listener 2. Lady in the Water 3. Just My Luck

Loss 曲线为: 

 

# 方法 2 – Neighborhood Methods

## 思路描述

这一种方法使用的是collaborative filtering中的 neighborhood methods算法

首先找出与目标用户口味相近的用户，根据相近度对其他用户排序。相近度通过两者共同评价过的电影的评分情况来衡量。

## 1.  计算用户间的相似度

这部分使用欧式距离计算两个用户间共同评价过的电影作为衡量依据,距离越大说明他们之间的差异越大.最后在对其取倒数,防止出现数值为零的情况,这时数值越接近1说明他们之间的相似度越大.

## 2.  评分标准化

因为不同用户对于电影的评分严苛程度不同,可能导致对不同用户感受相同的一部电影,因此而评分差异很大,为此我们要对数据进行标准化处理.下面是处理完之后的结果

![img](https://gitee.com/sun-roc/picture/raw/master/img/clip_image016.jpg)

## 3.  根据相似度和评分值计算推荐系数

推荐系数的计算方式为:对每一部目标用户没评分过但其他用户评分过的电影，求其他用户相近度*标准化后的评分的和，再除以这部电影被用户评分的次数。

## 结果分析

![image-20210130093425710](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130093425710.png)

可以看到经过Neighborhood Methods 算法计算后的推荐值与我们方法1得出的推荐顺序是一样的. Neighborhood Methods也就是根据每个用户的评分情况分析它们的口味、喜好,再找喜好接近的用户,根据它们的评分情况计算推荐系数来进行推荐。通过协同过滤的两种方法得出的推荐顺序结果大致相同,证明本次使用的两种方法都有较高的置信度,但是由于本次作业所给出的样本量较小,无法保证该方法在大数据量的条件下的可行性.

 