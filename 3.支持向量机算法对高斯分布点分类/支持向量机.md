# 基于支持向量机算法对高斯分布点分类

## 问题描述

A类点以（0，0）为中心、（1，0；0，1）为协方差矩阵的二维高斯分布；

B类点以（1，2）为中心、（1，0；0，2）为协方差矩阵的二维高斯分布；

随机生成300个A类点，200个B类点，并用SVM方法进行分类

## 数据生成

根据要求用numpy生成500个点，将位置坐标放入dataSet数组中,前三百个为A类点,后三百个为B类点。再生成一个label数组，包含300个1(用来表示A类)和200个2(用来表示B类).

画图展示生成的效果:

![image-20210130091413440](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130091413440.png)



## 利用线性核分类

首先使用线性核对样本进行分类,其中相关参数C表示错误项的惩罚系数,C越大，即对分错样本的惩罚程度越大，因此在训练样本中准确率越高，但是泛化能力降低；相反，减小C的话，容许训练样本中有一些误分类错误样本，泛化能力强。

对于C 值的选取,这里采用通过sklearn内置的GridSearchCV进行搜索,在0.1到10之间取五十个点,选择最佳的C值作为模型参数.

选定参数后进行训练,并把测试集输入训练好的模型内输出正确率,效果如下图所示:

![image-20210130091429164](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130091429164.png)

可以看到最佳C的取值为0.5 ,在测试集上的正确率为88%

然后绘制根据模型的参数绘制可视化分类图,黑色实线为决策边界,虚线为支持向量.

![image-20210130091445789](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130091445789.png)

## 利用高斯核进行分类

高斯核是非线性核,它可以将低维空间映射到高维空间里去解决线性不可分的问题。西瓜书里的核函数有讲到：如果原始空间是有限维，即属性数有限，那么一定存在一个高维特征空间使样本可分。简而言之，高维空间中的线性决策界实际上是低维空间的非线性决策界。

非线性核的参数C与线性核的含义相同,其相比于线性核多了参数gamma,gamma可以被理解为高斯球面的阶段参数，gamma越大，产生更加柔和的决策界，但是值得注意的地方是，gamma值较大的模型对训练集效果很大，但其泛化能力一般很差，因此选择\
合适的gamma值有助于避免过拟合.

在这里同样通过内置函数预先决策最优的C和gamma参数的取值,结果如图:

![image-20210130091508345](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130091508345.png)

然后根据训练结果参数绘制可视化分类图,黑色实线为决策边界,虚线为支持向量部分.

![image-20210130091515961](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130091515961.png)

## 利用Sigmoid核进行分类

Sigmoid核的参数与高斯核的参数基本上一致,因此不再赘述,其结果为:

![image-20210130091525115](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130091525115.png)

![image-20210130091534112](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130091534112.png)

## 利用Poly核进行分类

三个非线性核的调用过程大致相同因此封装到一个函数中,通过不同的参数名调用不同的核函数并输出结果和决策曲线.

![image-20210130091553419](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130091553419.png)

![image-20210130091600849](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130091600849.png)

## 结果分析

![image-20210130091630421](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130091630421.png)

通过对比不同核函数下,模型在测试集上的正确率,和所绘制的决策界面我们可以发现,使用了非线性的核函数的情况下,模型的正确率相比于线性核持平或有所下降,使用线性核对模型的增益不高,因此可以得出该分布是近似于线性可分的.

同样通过可视化图形也可以看到,不同核函数下,决策界面都近似于一条直线,印证了上面的结论.
