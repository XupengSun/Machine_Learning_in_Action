# 问题描述

A类点以（0，0）为中心、（1，0；0，1）为协方差矩阵的二维高斯分布；

B类点以（1，2）为中心、（1，0；0，2）为协方差矩阵的二维高斯分布；

随机生成300个A类点，200个B类点，并用并用K-Means进行聚类。

# 实现步骤

## 数据生成

用numpy生成500个点，将位置坐标放入dataSet数组中,前三百个为A类点,后三百个为B类点。再生成一个label数组，包含300个1(用来表示A类)和200个2(用来表示B类).

画图展示生成的效果:

![image-20210130092801268](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130092801268.png)

## 随机生成中心点

构造随机生成中心点的函数,使用numpy内置方法从500个样本点中随机选取2个点作为本次分类的初始中心点,并将中心点的坐标数组返回.

##  样本点归类

通过for循环遍历所有样本点,通过计算欧几里得距离为样本点依据距离中心点的距离分类.然后更新样本点的类别,如果类别相对于上次发生改变,则仍将迭代标志置为True,进行下一次迭代.

## 更新中心点和迭代

每次给样本点归类后都使用numpy内置的取均值函数,根据每个分类内的所有样本点坐标计算一下新的中心点坐标.不停的重复3,4两个步骤,直至所有样本点的类别不再发生改变后停止迭代,输出相应的结果.

## 损失的度量

在程序中,关于迭代过程中损失的度量,选取每次更新中心点后,新的中心点距离上一次中心点的欧式距离作为损失的大小,并把A,B两类的损失值通过折线图的形式表现出来.

可以看到迭代的过程中,损失是逐渐减小并很快趋近于零的,可见模型的有效性且具有较高的效率可以很快的到达最优点.

![image-20210130092905771](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130092905771.png)

![image-20210130092917678](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130092917678.png)

# 结果分析

![image-20210130092927113](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130092927113.png)

可以看到,对于本次实验生成的高斯随机点,通过Kmeans聚类的类中心点坐标为\[1.0,2.3\]和\[0,0\],结果基本符合生成程序中的中心点坐标. 程序经过6轮共计3000次的迭代最终正确率可以达到86%左右,模型效果符合预期.

具体的可视化效果如下图所示,黑色和绿色菱形为最终得出的聚类中心点.同时根据对样本点的分类重新绘制样本点颜色.

![image-20210130092933257](https://gitee.com/sun-roc/picture/raw/master/img/image-20210130092933257.png)
